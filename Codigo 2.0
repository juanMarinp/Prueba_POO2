from datetime import date

class Persona:
    def __init__(self,nombre,apellido,rut,edad):
        self.nombre = nombre
        self.apellido = apellido
        self.rut = rut
        self.edad = edad
        return
class Medico(Persona):
    def __init__(self,nombre,apellido,rut,edad,codigo_medico,especialidad):
        Persona.__init__(self,nombre,apellido,rut,edad)
        self.codigo_medico = codigo_medico
        self.especialidad = especialidad
    def mostrarDatos(self):
        print('INFORMACIÓN MEDICO:')
        print('Nombre:',self.nombre,self.apellido,'| Rut:',self.rut,'| Código:',self.codigo_medico,'| Especialidad:',self.especialidad)
        return
class Encargado(Persona):
    def __init__(self,nombre,apellido,rut,edad,codigo_cliente):
        Persona.__init__(self,nombre,apellido,rut,edad)
        self.codigo_cliente = codigo_cliente
    def mostrarDatos(self):
        print('INFORMACION ENCARGADO:')
        print('Nombre:',self.nombre,self.apellido,'| Rut:',self.rut,'| Código:',self.codigo_cliente,'| Edad:',self.edad)
        return
class Mascota:
    def __init__(self,nombre,codigoMascota,especie,raza,encargado):
        self.nombre = nombre
        self.codigoMascota = codigoMascota
        self.especie = especie
        self.raza = raza
        self.encargado = encargado
    def mostrarDatos(self):
        print('INFORMACION MASCOTA:')
        print('Nombre:',self.nombre,'| Código:',self.codigoMascota,'| Especie:',self.especie,'| Raza:',self.raza)
        self.encargado.mostrarDatos()
        return
class Ficha:
    def __init__(self,folio,mascota,medico,fecha,diagnostico):
        self.folio = folio
        self.mascota = mascota
        self.medico = medico
        self.fecha = fecha
        self.diagnostico = diagnostico
        return
    def mostrarDatos(self):
        print('INFORMACION FICHA:')
        print('Folio Nº:',self.folio,'| Fecha: ',self.fecha,'| Diagnostico: ',self.diagnostico)
        self.mascota.mostrarDatos()
        self.medico.mostrarDatos()
        return
listaMedico = [
Medico('Jesus','rojas','12457896',22,1000,'General'),
Medico('Juan','Marin','15215796',20,1001,'Cirugano')
]
listaEncargado = [
Encargado('sebastian','Pizarro','25896314',36,2000),
Encargado('Jose','dinamarca','15987635',25,2001)
]
listaMascota = [
Mascota('Cachupin',3000,'Perro','Pastor Alemán',listaEncargado[0]),
Mascota('lula',3001,'Gato','Burmes',listaEncargado[1])
]
listaFicha = [
Ficha(4000,listaMascota[0],listaMedico[0],'20/05/2021','fiebre'),
Ficha(4001,listaMascota[1],listaMedico[1],'07/10/2021','esterilizacion')
]

#los identificadores se crearan automaticamente para mantener el orden
id_ficha = 4002
id_encargado = 2002
id_mascota = 3002

pregunta100 = True
#La fecha se obtendra automaticamente del sistema
today = date.today()
d1 = today.strftime("%d/%m/%Y")

print('...BIENVENIDO...\n')

#*******Agregar cliente*******
while pregunta100:
    pregunta3 = input('Desea ingresar un nuevo cliente?[S/n]: ')

    while pregunta3.upper() == 'S':
        codigo_encargado = id_encargado
        nombre_encargado = input('Ingrese nombre: ')
        apellido_encargado = input('Ingrese apellido: ')
        rut_encargado = input('Ingrese Rut: ')
        while len(rut_encargado) != 8:
            print('...Rut debe contener 8 dígitos...')
            rut_encargado = input('Ingrese Rut: ')
        for x in listaEncargado:
            while x.rut == rut_encargado:
                print('...Rut ya existe...')
                rut_encargado = input('Ingrese Rut: ')
        edad_encargado = int(input('Ingrese edad: '))
        listaEncargado.append(Encargado(nombre_encargado,apellido_encargado,rut_encargado,edad_encargado,codigo_encargado))
        print('...CLIENTE AGREGADO CON EXITO!...')
        print('ID Cliente : [',id_encargado,']')
        id_encargado+=1
        pregunta3 = input('Desea ingresar un nuevo cliente?[S/n]: ')

    #*******Agregar mascota*******
    listaCodigosEncargado = []
    for x in listaEncargado:
        listaCodigosEncargado.append(x.codigo_cliente)
    pregunta4 = input('Desea ingresar una nueva mascota?:[S/n]:')

    while pregunta4.upper() == 'S':

        codigo_mascota = id_mascota
        nombre_mascota = input('Ingrese nombre: ')
        especie_mascota = input('Ingrese especie: ')
        raza_mascota = input('Ingrese raza: ')
        encargado_mascota = int(input('Ingrese código encargado: '))
        for x in listaEncargado:
            while encargado_mascota not in listaCodigosEncargado:
                print('...Encargado no existe...')
                encargado_mascota = int(input('Ingrese código encargado: '))

            #*******encontrar index*******
        indexEncargado = listaCodigosEncargado.index(encargado_mascota)
        
        listaMascota.append(Mascota(nombre_mascota,codigo_mascota,especie_mascota,raza_mascota,listaEncargado[indexEncargado]))
        print('...MASCOTA AGREGADA CON EXITO...')
        print('ID Mascota: [',id_mascota,']')
        id_mascota+=1
        pregunta4 = input('Desea ingresar una nueva mascota?:[S/n]:')

    #*******buscar mascota por numero*******
    listaCodigosMascota = []
    for x in listaMascota:
            listaCodigosMascota.append(x.codigoMascota)

    pregunta = input("Desea buscar una mascota?[S/n]:")

    while pregunta.upper() == 'S': 

        buscarMascota = int(input("Ingrese el numero de la mascota: "))

        if buscarMascota in listaCodigosMascota:

            for x in listaMascota:
                if buscarMascota == x.codigoMascota:
                    x.mostrarDatos()
        else:
            print('...Codigo no existe...')

        pregunta = input("Desea buscar una mascota?[S/n]:")

    #*******Mostras medicos*******
    pregunta2 = input('Desea desplegar un listado de los medicos?:[S/n]')

    if pregunta2.upper() == 'S':

        for x in listaMedico:
            x.mostrarDatos()
    #*******Crear ficha medica*******

    pregunta7 = input('Desea crear una ficha medica?[S/n]: ')

    while pregunta7.upper() == 'S':
        
        listaCodigosMedico = []
        for x in listaMedico:
            listaCodigosMedico.append(x.codigo_medico)

        numero_folio = id_ficha
        mascota_folio = int(input('Ingrese el código de la mascota: '))
        while mascota_folio not in listaCodigosMascota:
            print('...Código no existe...')    
            mascota_folio = int(input('Ingrese el código de la mascota: '))
        medico_folio = int(input('Ingrese código del médico: '))
        while medico_folio not in listaCodigosMedico:
            print('...Código no existe...')
            medico_folio = int(input('Ingrese código del médico: '))
        fecha_folio = d1
        diagnostico_folio = input('Ingrese diagnóstico: ')

        #*******encontrar index*******
        indexMascota = listaCodigosMascota.index(mascota_folio)
        indexMedico = listaCodigosMedico.index(medico_folio)

        listaFicha.append(Ficha(numero_folio,listaMascota[indexMascota],listaMedico[indexMedico],fecha_folio,diagnostico_folio))
        print('...FICHA CREADA CON EXITO...')
        print('Folio Nº: [',id_ficha,']')
        id_ficha+=1
        pregunta7 = input('Desea crear una ficha medica?[S/n]: ')

    #*******Mostrar todas las fichas*******
    pregunta6 = input('Desea ver todas las fichas existentes?[S/n]: ')

    if pregunta6.upper() == 'S':

        for x in listaFicha:
            x.mostrarDatos()
            print('*****************************************')

    #*******Buscar ficha*******

    listaCodigosFicha = []
    for x in listaFicha:
       listaCodigosFicha.append(x.folio)

    pregunta5 = input('Desea buscar una ficha?[S/n]: ')

    while pregunta5.upper() == 'S':

        numeroFicha = int(input('Ingrese el numero de la ficha: '))

        if numeroFicha in listaCodigosFicha:

            for x in listaFicha:
                if x.folio == numeroFicha:
                    x.mostrarDatos()
        else:
            print('...Nº folio no existe...')

        pregunta5 = input('Desea buscar una ficha?[S/n]: ')

    pregunta100 = input('Desea salir del programa?[S/n]: ')
    if pregunta100.upper() == 'S':
        pregunta100 = False

print('...PROGRAMA FINALIZADO, HASTA PRONTO!...')

